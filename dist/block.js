(()=>{"use strict";const e=window.wp.blocks,s=window.wp.element,t=window.wp.components,l=window.wp.blockEditor,n=window.ReactJSXRuntime;(0,e.registerBlockType)("post-slideshow/slideshow-block",{title:"Slideshow Block",icon:"images-alt",category:"widgets",edit:e=>{const{attributes:o,setAttributes:i}=e,[r,a]=(0,s.useState)(!o.url),[c,d]=(0,s.useState)(o.url||""),[h,u]=(0,s.useState)([]),[x,w]=(0,s.useState)(!1),[j,p]=(0,s.useState)(0),[g,m]=(0,s.useState)(!0),[b,k]=(0,s.useState)(!1),v=(0,s.useRef)(),f=async e=>{if(e){w(!0);try{const s=await fetch(`${e}/wp-json/wp/v2/posts`),t=await s.json(),l=await Promise.all(t.map((async s=>{const t=await fetch(`${e}/wp-json/wp/v2/media/${s.featured_media}`),l=await t.json();return{...s,featured_media_url:l.source_url}})));u(l)}catch(e){console.error("Error fetching posts:",e)}finally{w(!1)}}};return(0,s.useEffect)((()=>{c&&f(c)}),[c]),(0,n.jsxs)("div",{children:[(0,n.jsx)(l.BlockControls,{children:(0,n.jsx)(t.ToolbarGroup,{children:(0,n.jsx)(t.ToolbarButton,{icon:"edit",label:"Edit URL",onClick:()=>a(!0)})})}),(0,n.jsxs)(l.InspectorControls,{children:[(0,n.jsx)(t.TextControl,{label:"API URL",value:c,onChange:e=>d(e)}),(0,n.jsx)(t.Button,{onClick:()=>f(c),disabled:x,children:x?"Loading...":"Load Slideshow"}),(0,n.jsx)(t.ToggleControl,{label:"Show Title",checked:g,onChange:()=>m(!g)}),(0,n.jsx)(t.ToggleControl,{label:"Show Excerpt",checked:b,onChange:()=>k(!b)})]}),r?(0,n.jsxs)("div",{children:[(0,n.jsx)(t.TextControl,{label:"Enter URL",value:c,onChange:e=>{i({url:e}),d(e)}}),(0,n.jsx)(t.Button,{isPrimary:!0,onClick:()=>{a(!1),f(c)},children:"Done"})]}):x?(0,n.jsx)("p",{children:"Loading..."}):(0,n.jsx)("div",{className:"slider-container",children:h.length>0?(0,n.jsxs)("div",{className:"slider",ref:v,children:[(0,n.jsx)("div",{className:"slides",children:h.map(((e,s)=>(0,n.jsx)("div",{className:"slide "+(s===j?"active":""),children:(0,n.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:[(0,n.jsx)("div",{className:"slide-image",style:{backgroundImage:`url(${e.featured_media_url})`}}),g&&(0,n.jsx)("h3",{children:e.title.rendered}),b&&(0,n.jsx)("p",{children:e.excerpt.rendered})]})},e.id)))}),(0,n.jsxs)("div",{className:"controls",children:[(0,n.jsx)("button",{onClick:()=>{p(j>0?j-1:h.length-1)},className:"prev-btn",children:"Prev"}),(0,n.jsx)("button",{onClick:()=>{j<h.length-1?p(j+1):p(0)},className:"next-btn",children:"Next"})]})]}):(0,n.jsx)("p",{children:"No posts found."})})]})},save:()=>null})})();