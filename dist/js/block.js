(()=>{"use strict";const e=window.wp.blocks,t=window.wp.element,s=window.wp.components,o=window.wp.blockEditor,i=window.ReactJSXRuntime;(0,e.registerBlockType)("post-slideshow/slideshow-block",{title:"Slideshow Block",icon:"images-alt",category:"widgets",edit:e=>{const{attributes:l,setAttributes:n}=e,[r,a]=(0,t.useState)(!l.url),[d,c]=(0,t.useState)(l.url||""),[u,w]=(0,t.useState)([]),[h,j]=(0,t.useState)(!1),p=async e=>{if(e){j(!0);try{const t=await fetch(`${e}/wp-json/wp/v2/posts`),s=await t.json(),o=await Promise.all(s.map((async t=>{const s=await fetch(`${e}/wp-json/wp/v2/media/${t.featured_media}`),o=await s.json();return{...t,featured_media_url:o.source_url}})));w(o)}catch(e){console.error("Error fetching posts:",e)}finally{j(!1)}}};return(0,t.useEffect)((()=>{d&&p(d)}),[d]),(0,i.jsxs)("div",{children:[(0,i.jsx)(o.BlockControls,{children:(0,i.jsx)(s.ToolbarGroup,{children:(0,i.jsx)(s.ToolbarButton,{icon:"edit",label:"Edit URL",onClick:()=>a(!0)})})}),(0,i.jsxs)(o.InspectorControls,{children:[(0,i.jsx)(s.TextControl,{label:"API URL",value:d,onChange:e=>c(e)}),(0,i.jsx)(s.Button,{onClick:()=>p(d),disabled:h,children:h?"Loading...":"Load Slideshow"})]}),r?(0,i.jsxs)("div",{children:[(0,i.jsx)(s.TextControl,{label:"Enter URL",value:d,onChange:e=>{n({url:e}),c(e)}}),(0,i.jsx)(s.Button,{isPrimary:!0,onClick:()=>{a(!1),p(d)},children:"Done"})]}):h?(0,i.jsx)("p",{children:"Loading..."}):(0,i.jsx)("div",{className:"slideshow-editor",children:u.length>0?u.map((e=>(0,i.jsx)("div",{className:"slide",children:(0,i.jsxs)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",children:[(0,i.jsx)("img",{src:e.featured_media_url,alt:e.title.rendered}),(0,i.jsx)("h3",{children:e.title.rendered}),(0,i.jsx)("p",{children:e.date})]})},e.id))):(0,i.jsx)("p",{children:"No posts found."})})]})},save:()=>null})})();